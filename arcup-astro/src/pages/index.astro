---
import BaseLayout from "../layouts/BaseLayout.astro";
import ArcCanvas from "../components/ArcCanvas.astro";
import SiteHeader from "../components/SiteHeader.astro";
import DefinitionContent from "../components/DefinitionContent.astro";
import PageNavigation from "../components/PageNavigation.astro";
import '../styles/home-definition-page.css';

// IMPROVED SEO
const title = "arc^ - Open Plasma Research for Ecological Restoration";
const description = "arc^ is regenerative plasma research done in the open. We explore plasma-activated water for agriculture and restoration, publishing protocols freely under RE:TECH principles: transparent, collaborative, and regenerative.";
const siteUrl = Astro.site ? new URL("/", Astro.site).toString() : undefined;

const seo = {
  canonical: siteUrl,
  openGraph: {
    title: "arc^ byali - Open Science for a Better World",
    description,
    url: siteUrl,
    type: "website",
    image: `${import.meta.env.BASE_URL}favicon.svg`,
  },
  twitter: {
    title,
    description,
    card: "summary_large_image",
    image: `${import.meta.env.BASE_URL}favicon.svg`,
  },
};

const structuredData = {
  "@context": "https://schema.org",
  "@type": "Organization",
  name: "arc^ byali",
  alternateName: "arcup",
  description,
  url: siteUrl,
  logo: `${siteUrl}favicon.svg`,
  founder: {
    "@type": "Person",
    name: "ali",
    url: "https://www.xbyali.page"
  },
  sameAs: [
    "https://www.youtube.com/@arc-arcup",
    "https://discord.gg/DA8BPA3VsN",
    "https://github.com/arcup"
  ],
  keywords: "plasma research, open science, regenerative technology, plasma activated water, ecological restoration, community science, RE:TECH, sustainable agriculture, environmental remediation",
  areaServed: "Global",
  knowsAbout: [
    "Plasma Technology",
    "Regenerative Agriculture", 
    "Open Science",
    "Environmental Restoration",
    "Community Research"
  ],
  hasOfferCatalog: {
    "@type": "OfferCatalog",
    name: "Research Protocols",
    itemListElement: [
      {
        "@type": "Offer",
        itemOffered: {
          "@type": "Service",
          name: "Plasma Research Protocols",
          description: "Open-source plasma research methods for ecological restoration"
        }
      }
    ]
  }
};
---

<BaseLayout 
  title={title}
  description={description} 
  bodyClass="page-definition" 
  seo={seo}
>
  <!-- Structured Data for SEO -->
  <script type="application/ld+json" slot="head" set:html={JSON.stringify(structuredData)} />
  
  <!-- Additional SEO meta tags -->
  <meta slot="head" name="keywords" content="plasma research, open science, regenerative agriculture, plasma activated water, ecological restoration, RE:TECH, community research, sustainable technology, environmental science, open source research" />
  <meta slot="head" name="author" content="ali" />
  <meta slot="head" property="og:locale" content="en_US" />
  <meta slot="head" property="og:image:alt" content="arc^ â€” Open plasma research for ecological restoration" />
  <meta slot="head" name="geo.region" content="AU" />
  <meta slot="head" name="geo.placename" content="Australia" />
  <meta slot="head" name="language" content="en" />
  <meta slot="head" name="revisit-after" content="7 days" />
  <meta slot="head" name="distribution" content="global" />
  <meta slot="head" name="rating" content="general" />
  <meta slot="head" name="category" content="Science and Technology" />
  
  <!-- Additional structured data for better AI understanding -->
  <script slot="head" type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "arc^ byali",
      "url": "https://arcup.xbyali.page",
      "description": "Open plasma research for regenerative futures",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://arcup.xbyali.page/search?q={search_term_string}",
        "query-input": "required name=search_term_string"
      },
      "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": [
          "h1#definition-title",
          ".definition-lede"
        ]
      }
    }
  </script>
  
  <ArcCanvas />
  <SiteHeader active="home" />
  <DefinitionContent />
  <PageNavigation currentPage="home" />
  
  <!-- Page-scoped script: lightweight pronunciation fallback using Web Speech API -->
  <script slot="scripts" is:inline>
    (() => {
      const btn = document.querySelector('.audio-button');
      if (!btn || !('speechSynthesis' in window)) return;
      btn.addEventListener('click', () => {
        try {
          window.speechSynthesis.cancel();
          const u = new SpeechSynthesisUtterance('arc up');
          const vs = window.speechSynthesis.getVoices();
          const au = vs.find(v => v.lang?.toLowerCase().includes('en-au') || v.name?.toLowerCase().includes('australian'))
            || vs.find(v => v.lang?.toLowerCase().startsWith('en'));
          if (au) u.voice = au;
          u.rate = 0.9; u.pitch = 1.0;
          window.speechSynthesis.speak(u);
        } catch {}
      });
    })();
  </script>
</BaseLayout>